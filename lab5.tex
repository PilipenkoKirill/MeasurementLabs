%!TEX program = xelatex.exe
\documentclass[14pt,a4paper]{article}
\input{setup.tex}
\title{Лабораторная работа №5 \\ \textit{Использования метода наименьших квадратов для аппроксимации результатов совместных измерений}}
\begin{document}
\maketitle
Пусть имеется два набора экспериментальных данных: $x_{i}$ и $y_{i}$, где ${i=1,...n}$ такие что между ними предполагается зависимость вида $y = f(x)$. 
Вводится некоторая (в простейшем случае линейная) функция $f(x, \{a_i\})$, которая определяется множеством неизвестных параметров $\{a_i\}$, где $i={1,...n}$.

Ставится задача получить такое множество, чтобы совокупность погрешностей $r_i=y_i-f(x_i, \{a_i\})$ была в некотором смысле минимальной.

Согласно методу наименьших квадратов решением этой задачи является набор параметров $\{a_i\}$, который минимизирует некоторую функцию:
\begin{equation} \label{leastSquares}
    g(\{a_i\}) = \sum\limits^n_{i=0} (y_i-f(x_i, \{a_i\}))^2.
\end{equation}

Пусть между данными предположительно имеется линейная зависимость, того $n=2$ и $\{a_i\} = \{a_1,a_2\}$, а функция $f(x, a_1, a_2) = a_1x + a_2$. Чтобы функция $g(a_1,a_2)$ из уравнения \ref{leastSquares} была минимальна достаточным условием является равенство нулю её частных производных:
\begin{equation}
    \begin{cases}
        \left (\frac{\partial g(a_1,a_2)}{\partial a_1} \right )_{a_2} = 0 \\
        \left (\frac{\partial g(a_1,a_2)}{\partial a_2} \right )_{a_1} = 0
    \end{cases},
\end{equation}
где $\left (\frac{\partial g(a_1,a_2)}{\partial a_1} \right )_{a_2}$~---~производная функции по $a_1$ при постоянной $a_2$.

\progress{}
\begin{enumerate}
    \item Аппроксимировать зависимость будем квадратичной функцией вида $f(x,a,b,c) = ax^2 + bx + c$;
    \item 
\end{enumerate}

\begin{center}
	\textbf{\Large Приложение}
\end{center}
\lstset{ %
	language=[Visual]Basic,
	keywordstyle=\color{brown},          % Стиль ключевых слов
	breaklines=true,
	numbers=left, 
	backgroundcolor=\color{lightgray!5!white},
	tabsize=4,
	label=NormDistGen, 
	caption={Код генератора выборки}
	} 
	\renewcommand{\lstlistingname}{Листинг}
\begin{lstlisting}
	Dim i As Long
	Dim mean As Integer
	Dim sigma As Integer
	Dim random As Double

	mean = 10 * Rnd + 6
	sigma = 3 * Rnd + 2
	i = 501
	Range("A1").Select
	For i = 2 To i
		random = WorksheetFunction.NormInv(Rnd, mean, sigma)
		ActiveCell.Value = random
		ActiveCell.Offset(1, 0).Select
	Next i
	\end{lstlisting}
\end{document}